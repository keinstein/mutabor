\input{preamble.tex}
\subject{Reference manual}
\externaldocument{manual}
\externaldocument{help}
\begin{document}
\ifhtml
\setcounter{tocdepth}{1}
\fi

\maketitle
%\ifhtml\else\clearpage\fi
\ifhtml\ifhelp\else
\section*{Availlable formats of this reference}
You can read and print this reference in the following formats:

\HCode{<?php require_once(\dq \cdoronline{}\urlbase includes/hilfsfkt.inc\dq);?>\Hnewline
  <div class=\dq dokumentation download tex4ht-vorspann\dq>\Hnewline
<table class=\dq beitraege\dq>\Hnewline
  <tbody class=\dq beitraege\dq >\Hnewline
  <tr class=\dq beitraege\dq >	\Hnewline
    <th
      class=\dq beitraege\dq ><a href=\dq
      \jobname.html\dq class=\dq link\dq>\jobname.html</a></th>\Hnewline
   <td class=\dq beitraege\dq >The document you are reading currently. </td>\Hnewline
  </tr>\Hnewline
  <tr class=\dq beitraege\dq >\Hnewline
    <th
      class=\dq beitraege\dq ><?=dateilink(\dq \jobname.ps\cdoronline{}{.bz2}\dq )?></th>\Hnewline
    <td class=\dq beitraege\dq >PostScript for printing</td>\Hnewline
  </tr>\Hnewline
  <tr class=\dq beitraege\dq >\Hnewline
    <th class=\dq beitraege\dq ><?=dateilink(\dq \jobname.pdf\dq )?></th>\Hnewline
    <td class=\dq beitraege\dq >PDF for printing</td>\Hnewline
  </tr>\Hnewline
  </tbody>\Hnewline
</table>\Hnewline
</div>}
\Css{div.tex4ht-vorspann { 
    margin-bottom: 2em; 
    width:30em;
    width:auto;
    max-width:30em;
}}
\fi
\else
\tableofcontents
\fi

\iffalse

% Nummerierung der Kapitel
% damit es linear weitergeht (Nach dem Anhang...)
%
%\setcounter{chapter}{\value{savedchapter}}%
%                           % Muss im Bedienungshandbuch 
%                           % gesetzt werden (vor \appendix)
%\setcounter{savedchapter}{\value{page}} % muss nach \mainmatter
%                                % wiederhergestellt werden.
%\setcounter{section}{0}%
%\def\thechapter{\arabic{chapter}}% 
%\global\let\chapter\savedchaptercommand
%\mainmatter
%\setcounter{page}{\value{savedchapter}}
%\makeatletter
%\xdef\@chapapp{\chaptername}%
%\ifx\theHchapter\undefined
%\else
%\renewcommand\theHchapter    {\arabic{chapter}}
%\renewcommand\theHfigure     {\theHchapter.\arabic{figure}}
%\renewcommand\theHtable      {\theHchapter.\arabic{table}}
%\renewcommand\theHsection    {\theHchapter.\arabic{section}}
%\def\Hy@chapapp{\Hy@chapterstring}
%\fi
%\makeatother
\fi


\hyphenation{Har-mo-nie-na-me
	     Har-mo-nie-na-men
	     kon-sis-tent kon-sis-ten-te kon-sis-ten-ter}

\newcommand{\bi}{\begin{itemize}}
\newcommand{\ei}{\end{itemize}}


\pagestyle{headings}

\chapter{language reference}\label{cha:sprachreferenz}
\label{eins}

On the one hand this reference manual shall be a short
is reference book, on the other hand, it provides the basic
description of 
the logic language of \mutabor{} dar. It is not suitable for the
Logical language to learn, for this we direct the reader to the
Operation manual, but it provides exact information for dubious
questions.
The reference manual is designed to
determine the functionality of the logic language. When a user
 of \mutabor{} encounters that a programmed logic 
doesn't work the way he wants it to, then this
reference manual will be the decision-making body, against which he
can check whether the program logic is wrong, or whether
\mutabor{} not work correctly.
This section describes the logic language \mutabor{} in version 3.0.
\iffalse
Das Referenzhandbuch soll einerseits ein kurzes
Nachschlagewerk sein, andererseits stellt es die Basisbeschreibung
der Logiksprache \mutabor{} dar. Es ist nicht dafür geeignet, die
Logiksprache zu erlernen, dafür sei an dieser Stelle auf das
Bedienungshandbuch verwiesen, sondern gibt bei zweifelhaften
Fragen exakte Auskünfte. Das Referenzhandbuch ist dafür gedacht,
die Funktionalität der Logiksprache festzulegen. Wenn ein Benutzer
von \mutabor{} feststellt, daß eine von ihm programmierte Logik
nicht so funktioniert, wie er es wünscht, so ist dieses
Referenzhandbuch die Entscheidungsinstanz, anhand derer man
feststellen kann, ob das Logikprogramm falsch ist, oder ob
\mutabor{} nicht korrekt funktioniert.
Dieser Abschnitt beschreibt die Logiksprache \mutabor{} in der Version
3.0.
\fi


\chapter{Lexical conventions}\label{cha:lexik-konv}
\label{zwei}

A program consists of a text, that is saved in a file. It will be
compiled in one single phase.
\iffalse
Ein Programm besteht aus einem Text, der in einer Datei gespeichert ist.
Es wird in einer einzigen Phase übersetzt.
\fi

\section{Input symbols}\label{sec:eingabesymbole}
\index{input symbols}
\label{zweieins}

There are five classees \index{word class} of input symbols:
Names\index{Name}, reserved words\index{word!reserved},
numbers,
operators  and  other
delimiters.  Spaces,\index{space} tabulators,
vertical tabulators,
line feeds,\index{line feed} page feeds\index{page feed}
as well as comments\index{comments},
usually denoted as white space,  will be ignored, with the exception
that they are necessery to distinguish direct neigbouring names,
numbers or reserved words.

If the input been already dissambled up to a certain character, the
next symbol will be the most possible string of characters, which can
be interpreted as an input symbol.

\section{Comments}\label{sec:kommentare}
\index{comment}
\label{zweizwei}

Comments\index{comment} an entailed in douple quotes ({\tt
  \dq})\index{*''@\dq (double quote)}.
Comments cannot be nested, but can span multiple lines.

\section{Names}\label{sec:namen}
\label{zweidrei}

A name \index{name} is a sequence of
letters and numerals; the
first character must be alphabetic. This includes
the underscore (\_) \index{*_@\_ (underscore)} and the apostrophe
({\bf'}) \index{*'@\textapostrophe\ (apostrophe)}.\footnote {The underscore is one of the letters, so
you can write meaningful names legibly, e.\,g.,
{\tt LOGIC third\_tone\_mutating} is better than
{\tt LOGIC thirdtonemutating},
and the apostrophe counts as a letter
so that tone with a simple or multiple apostrophies can
provide the name, e.\,g {\tt TONE e${}'''$}}
Large and small letters are treated the same.
Names can be at any length.
To distinguish names of the entire name is used,
and not just the first few letters, as it is commen in other
programming laguages\index{significance}.
\iffalse
Ein Name\index{Namen} besteht aus einer Folge von
Buchstaben und Ziffern;  das
erste Zeichen muss ein Buchstabe sein.  Dabei zählen
der Unterstrich  (\_)\index{\_ (Unterstrich)} und der Apostroph
({\bf '})\index{#' (Apostroph)}
zu den Buchstaben.\footnote{Der Unterstrich zählt zu den Buchstaben, damit
man aussagekräftige Namen gut lesbar schreiben kann, z.\,B.
{\tt LOGIK Drittel\_Ton\_Mutierend} ist besser als
{\tt LOGIK dritteltonmutierend}
und der Apostroph zählt als Buchstabe,
damit man Töne mit einfach oder mehrfach gestrichenen
Namen versehen kann, z.\,B. {\tt TON e${}'''$ }}
Große und kleine Buchstaben werden gleich behandelt.
Namen können beliebig lang sein.
Zur  Unterscheidung von Namen wird der gesamte Name herangezogen,
und nicht nur die ersten paar Buchstaben, wie dies bei anderen
Programmiersprachen üblich ist\index{Signifikanz}.
\fi

In the books of \mutabor{} the terms {\it name} \index{name}
and {\it identifier}\index{identifier} are
used in parallel and with equal meaning. Furthermore, in some
syntax graphs also terms of the type {\it interval name}, {\it tone
  name}, \ldots are
used. These terms are considered syntactically as simple names.
Such a name describes that a particular type of
Objects are meant. In principle, this does not belong to the syntax
of the logic language, but will be checked later semantically. However, it increases
the understanding of the examples when seen directly, what kind of name
comes into question.
\iffalse
In den Büchern von \mutabor{} werden die Begriffe {\it Name}\index{Namen}
und {\it Bezeichner}\index{Bezeichner}
parallel und mit gleicher Bedeutung verwendet. Ferner werden bei einigen
Syntaxgraphen auch Begriffe der Art {\it Intervallname}, {\it Tonname},\ldots
verwendet. Diese Begriffe sind syntaktisch gesehen einfache Namen.
Es soll damit zum Ausdruck kommen, daß Namen einer bestimmten Art von
Objekten gemeint sind. Dies gehört prinzipiell nicht zur Syntax der
Logiksprache, sondern wird erst später semantisch überprüft. Es erhöht
jedoch das Verständnis, wenn direkt erkennbar ist, welche Art von Namen
in Frage kommt.
\fi

\section{Reserved words}\label{sec:reservierte-worte}
\label{zweivier}

The following words are reserved\index{Worte!reservierte}
and can be used only in their predefined meaning:

\begin{center}
\begin{tabular}{|llll|}
	      \hline
   ELSE & SHIFTED   & PATTERN & INTERVAL \\
   LOGIC  & MIDIIN   & MIDICHANNEL & MIDIOUT    \\
   KEY     & TONE    & TONESYSTEM &  RETUNING \\
   ROOT    &        &           &              \\
 \hline
\end{tabular}
\end{center}

Likewise, the folloging German key words can be used. They are also
reserved and must not be used as names.

%\vspace{1cm}
\begin{center}
\begin{tabular}{|llll|}
	      \hline
   ANSONSTEN & FORM   & HARMONIE & INTERVALL \\
   LOGIK  & MIDIIN   & MIDIKANAL & MIDIOUT    \\
   TASTE     & TON    & TONSYSTEM &   UMSTIMMUNG \\
   WURZEL    &        &           &              \\
 \hline
\end{tabular}
\end{center}
%\vspace{1cm}

All other words can be used as names or identifiers.

\section{Numbers}\label{sec:zahlen}
\index{number}
\label{zweifuenf}

Numbers can be integers or reals written with a decimal point. A
notation using decimal exponents is not allowed.\index{number}
Furthermore a number can start with the symbol \textbf{\#}\index{*#@\#}
and contain further hexadecimal digits\index{hex digit}. This notation
means, that the number will be evaluated as number with basis 16. In
the hexadecimal notation no decimal point is allowed, consequently,
only integers can be noted in this system.

\iffalse
Zahlen können ganzzahlig oder mit Dezimalpunkt geschrieben werden.
Eine Schreibweise mit Zehnerexponent ist nicht
zugelassen.\index{Zahlen} Ferner kann eine Zahl auch mit dem Zeichen
{\bf \#}\index{*#@\#} beginnen und weitere Hex-Ziffern\index{Hex-Ziffern}
enthalten. Diese Schreibweise bedeutet, daß die Zahl zur Basis 16
ausgewertet wird. In dieser Hex-Schreibweise ist kein Dezimalpunkt
erlaubt, folglich sind nur ganzzahlige Werte darstellbar.
\fi

Similar to names, numbers can be denoted in syntax diagrams like
of \textit{factor} or \textit{anchor key} in order to emphasize their
semantic meaning. Syntactically these are usual numbers.
\iffalse
Ähnlich wie bei Namen werden Zahlen im Syntaxdiagramm auch als {\it Faktor}
oder {\it Verankerungs-Taste} bezeichnet,
um ihre jeweilige semantische Bedeutung
hervorzuheben. Es handelt sich aber syntaktisch gesehen um ganz gewöhnliche
Zahlen.
\fi

At certain places only integers are allowed (e.\,g. as anchor key,
width of a tone system,\ldots) and at other places also decimal
fractions are allowed (tone frequency, interval size,\ldots).
\iffalse
An einigen Stellen sind nur ganze Zahlen zugelassen (z.\,B. als
Verankerungs-Taste, Tonsystem-Breite,\ldots) und an anderen Stellen
sind auch Komma-Zahlen zugelassen, (Tonfrequenz,
In\-ter\-vall\-gr"o"se,\ldots).
\fi



\chapter{Syntax description}\label{cha:syntax-schreibweise}
\label{drei}

In the description of the syntax in this book the notions of grammar
will be drawen in \emph{in rectangular boxes} and reserved words and
characters \emph{in boxes with rounded corners}. The syntax can be
derived by going along the arrows in the syntax diagram. Alternatives
can bee seen as branching points and repeating parts occure when the
diagram contains cycles. An Example:
\iffalse
In der Syntax-Darstellung in diesem Buch werden die Grammatikbegriffe
{\it in eckigen Kästchen} und reservierte Worte und Zeichen {\it in
ovalen Kästchen} geschrieben. Die Syntax erhält man, indem man auf den
Pfeilen entlang durch das Syntaxdiagramm läuft.
Alternative Formulierungen erscheinen dabei als Verzweigungen
und Wiederholungen ergeben sich, indem das Syntaxdiagramm Zyklen enthält.
Ein Beispiel:
\fi

\input{syn1.pic}

The word \textit{TONE} must be written exactyly as is, while the
construct \textit{simple tone} has to be further dissolved. The loop
has the effect, that multiple constructs of the form \textit{single
  tone} can follow each other.


\chapter{The  logik program}\label{cha:das-logikprogramm}
The logic is the top concept and corresponds to the complete
program. The logic program is an arbitrary sequence of
declarations\index{declaration}. Especially must be emphasized that
even an empty file is a permissible program. In this case no logic is
present and the 12 tone equal temperament\index{12tet}  will be used.
\iffalse
Das Logikprogramm ist der oberste Grammatikbegriff und entspricht
dem gesamten Programm. Das Logikprogramm selbst ist eine beliebige
Folge von Deklarationen\index{Deklarationen}.
Insbesondere ist hervorzuheben, daß auch
gar nichts, also ein leeres File, ein zulässiges Programm ist.
In diesem Fall ist keine Logik vorhanden und die normale
gleichstufig temperierte Stimmung eingestellt.
\fi

Intervals, tones, tone systems, retunings, harmonies, logics und MIDI
channels can be declared. The different elements can be declared in an
arbitrary order. In particular, elements can be referenced before they
are used.
\iffalse
Es können Intervalle, Töne, Tonsysteme, Umstimmungen, Harmonien,
Logiken und MIDI-Kanäle deklariert werden. Die einzelnen Elemente können
in beliebiger Reihenfolge deklariert werden. Insbesondere kann auf
Elemente Bezug genommen werden, die erst später deklariert werden.
\fi

\input{syn2.pic}

\chapter{Interval}\index{Interval}\label{cha:intervall}

An interval declaration defines individual intervals and the
corresponding values. Interval names must not be defined twice, but
can have the same name as objects of another kind. The value of an
interval ist its frequency proportion. It can be specified in one of
the three ways:
\begin{itemize}
\item as number ratio,
\item as root expression\index{root} or
\item as combination of other intervals.
\end{itemize}
\iffalse
Eine Intervalldeklaration definiert einzelne Intervalle und die
dazugehörenden Werte. Intervallnamen dürfen nicht doppelt definiert
werden, sie dürfen jedoch gleiche Namen tragen,
wie Objekte einer anderen Art.
Der Wert eines Intervalls ist ein Frequenzverhältnis.
Der Wert eines Intervalls kann auf eine von drei Arten angegeben werden:
\bi
  \item als Zahlenverhältnis,
  \item als Wurzelausdruck\index{Wurzel} oder
  \item als Kombination aus anderen Intervallen.
\ei
\fi
Here \keyword{Number1 : Number2} denotes the ratio
\begin{align*}
\frac{\text{\keyword{Number1}}}{\text{\keyword{Number2}}},
\end{align*}
and \keyword{A ROOT B} is  the \keyword
Ath root of \keyword B:
\begin{align*}
  \sqrt[\text{\keyword{A}}]{\text{\keyword B}}.
\end{align*}
Whenever intervals are combined from other intervals, so these
intervals must not have circular dependencies, but the values of the
intervals must be computable in a consistent form. Each interval that
is used to form another one must be declared in of the same logic
program. An interval can optionally be preceeded by a
factor\index{factor}. Then the value of this interval will be counted
multiple times. Since the intervals are frequency ratios, the value of
the value of the combined interval is determined multiplicative. For
example, the interval 
\begin{lstlisting}
  INTERVAL I = 3 octave - 5 third + 17 cent
\end{lstlisting}
will be calculated according to the following scheme:
\begin{align*}
  \mathtt I = \keyword{octave}^3 * \keyword{third}^{-5} * \keyword{cent}^{17}.
\end{align*}
\iffalse
Es bedeutet dabei
{\tt Zahl1 : Zahl2} das Verhältnis von Zahl1 zu Zahl2 und
{\tt A WURZEL B} ist die \keyword{A}te Wurzel aus \keyword{B}.
Wenn Intervalle aus anderen Intervallen zusammengesetzt werden,
so dürfen keine gegenseitigen Abhängigkeiten entstehen, sondern
die Werte der Intervalle müssen in konsistenter Form berechenbar sein.
Alle Intervalle die zum Zusammensetzen anderer Intervalle benutzt werden,
müssen innerhalb des Logik-Programms deklariert werden.
Optional kann einem Intervall auch ein Faktor\index{Faktor}
 vorangestellt werden, dann gilt der Wert dieses Intervalls
entsprechend mehrfach. Da es sich bei Intervallen eigentlich um
Frequenzverhältnisse handelt, ergibt sich der Wert eines zusammengesetzten
Intervalles multiplikativ. Zum Beispiel wird das Intervall
\begin{lstlisting} 
INTERVALL I = 3 oktave - 5 terz + 17 cent 
\end{lstlisting}
 nach folgendem Schema
berechnet: \[I = \mathtt{oktave}^{3} * \mathtt{terz}^{-5} * \mathtt{cent}^{17}\]
\fi

\input{syn3.pic}

\input{syn5.pic}

\chapter{Tone}\label{cha:ton}
\index{Tone}

A tone declaration defines individual tones and the corresponding
values. Tone names must not defined twice, but they can have the same
name as object of another kind. The value of the tone is a number,
which corresponds to the frequency of the pitch of the tone. It can be
a simple number or it can be calculated accordung to a reference
tone\index{tone!reference tone}, which can be moved by given
intervals. In the first case the frequency\index{frequency} is denoted
directly. In the other cases, after the sign of equality a name of a
reference tone follows together with a sequence of intervals, which
will be multiplied to the reference tone until the requested tone will
be reached. In principle, each tone must be defined in the logic
program, if it shall be used as a reference tone. Furthermore the
definitions of all tones must not contain circular dependencies.
\iffalse
Eine Tondeklaration definiert einzelne Töne und die
dazugehörenden Werte. Tonnamen dürfen nicht doppelt definiert
werden, sie dürfen jedoch gleiche Namen tragen,
wie Objekte einer anderen Art.
Der Wert eines Tons ist eine Zahl, die der Frequenz des Tons
entspricht. Der Wert eines Tons kann eine einfache Zahl sein oder
sich aus einem Bezugston\index{Bezugston}
 ergeben, der möglicherweise
um bestimmte Intervalle verschoben wird.
Im ersteren Fall wird die Frequenz\index{Frequenz}
 des Tons direkt angegeben.
Im anderen Fall folgt nach dem Gleichheitszeichen der Name eines
Bezugstons, sowie eine Folge von Intervallen, mit denen die Frequenz des
Bezugstons multipliziert wird, bis sie den gewünschten Ton ergibt.
Grundsätzlich müssen alle Töne, die als Bezugston herangezogen werden,
im Logikprogramm definiert sein. Ferner darf die Definition aller Töne
keine gegenseitigen Abhängigkeiten enthalten.
\fi

After it has been calculated each tone has a fixed
frequency. Correspondingly, the tone name is synonyme for an absolute
frequency\index{frequency!absolute}, whose value will be obtained
multiplicatively. Example:
\begin{lstlisting} 
TONE  bes = c - 2 fifth + octave 
\end{lstlisting}
will be calculated as 
\[
\text{frequency}(\keyword{b}) = \text{frequency}(\keyword{c}) *
\keyword{fifth}^{-2} * \keyword{octave}.
\]
\iffalse
Sämtliche Töne ergeben nach deren Berechnung immer eine feste Frequenz.
Ein Tonname steht also als Synonym für eine
absolute Frequenz\index{Frequenz!absolute}, deren
Wert sich multiplikativ ergibt. Beispiel:
\begin{lstlisting} 
TON  b = c - 2 quint + oktave 
\end{lstlisting}
wird berechnet als \[Frequenz(\mathtt{b}) = Frequenz(\mathtt{c}) *
\mathtt{quint}^{-2} * \mathtt{oktave}\].
\fi

\input{syn4.pic}



\chapter{Tone system}\label{cha:tonsystem}
\index{tone system} A tone system declaration defines individual tone
systems and the corresponding vlues. Names of tone systems must not be
defined twice. However, they can have the same name as objects of
another kind. A tone system consists of an anchor key\index{anchor
  key}, a set of tones, which is called fundamental scale, and an
period interval\index{interval!period interval}. The period interval
can be combined from other intervals. The fundamental scale consists
of a sequence of tones, wich must be eclosed by brackets
\textbf{[]}\index{*[]@[] (brackets)} and which have to be separated by
commas. It corresponds to a range on the piano keyboard. The
correspondence of the tone arises from the anchor key. This key
coresponds to the MIDI number\index{MIDI!number} of the first tone of
the fundamental scale.\footnote{The tone $c'$ corresponds to the MIDI
  number $60$.}
Starting at this position, the tones will be assigned to the piano
keys rightwards. The key right of the anchor key corresponds to the
second tone of the fundamental scale, etc\ldots\ . After all tones
have been assigned to the fundamental scale, the whole fundamental
scale is repeted above the assigned keys transposed by the period
interval\label{period interval} until the border of the claviature is
reached.

\iffalse
Eine Tonsystemdeklaration definiert einzelne Tonsysteme und die
dazugehörenden Werte. Tonsystemnamen dürfen nicht doppelt definiert
werden, sie dürfen jedoch gleiche Namen tragen,
wie Objekte einer anderen Art.
Ein Tonsystem besteht aus einer Verankerungstaste\index{Verankerungstaste},
einer Menge von Tönen
und einem Periodenintervall\index{Periodenintervall}.
Das Periodenintervall kann auch aus mehreren Intervallen
kombiniert werden.
Die Fundamentaltonleiter wiederum
besteht aus einer Folge von Tönen, die in eckigen Klammern
``{\bf [ ]}''\index{[ ] (eckige Klammern)}
 stehen und durch Kommata getrennt sind.
Sie entspricht einem Bereich auf der Klaviatur. Die Zuordnung der Töne
zu den Tasten ergibt sich durch die Verankerungstaste.
Sie entspricht der MIDI-Nummer\index{MIDI!Nummer} des ersten Tones der
Fundamentaltonleiter.\footnote{Das eingestrichene $c'$ entspricht
der MIDI-Tastennummer 60.}
Von dieser Position aus werden nach rechts folgend die weiteren Töne
den Klaviaturtasten zugeordnet. Die nächste Taste rechts daneben entspricht
folglich dem zweiten Ton der Fundamentaltonleiter, etc\ldots\ .
Wenn nach diesem Schema
alle Töne der Fundamentaltonleiter zugeordnet sind, wird die gesamte
Fundamentaltonleiter sowohl nach unten, wie nach oben wiederholt und
dabei um das Periodenintervall\label{Periodenintervall}
verschoben, bis die Grenzen der Klaviatur erreicht sind.
\fi

In the declaration of the fundamental scale\index{fundamental scale}
several tones cab be omitted, but not the separating commas. The
ommited tones cause the effect, that the corresponding keys will
produce no sound. Omitted tones will counted as nomal tons in the mapping $piano
key \rightarrow tone$ as if they were present.
\iffalse
Bei der Deklaration der Fundamentaltonleiter\index{Fundamentaltonleiter}
dürfen einzelne Töne fehlen, nicht jedoch die trennenden Kommata.
Diese fehlenden Töne bewirken,
daß die entsprechende Taste keinen Ton erzeugt.
Fehlende Töne werden bei der Zuordnung
$Klaviaturtaste \rightarrow Ton$ normal
mitgezählt, als wären sie vorhanden.
\fi



\input{syn6.pic}


\chapter{Retuning}\label{cha:umstimmung}
\index{retuning}
A retuning declaration defines individual retunings and the
corresponding values. Retuning names must not be defined twice, but
they can have the same name as objects of another kind. A retuning
contains rules, how to change the current
tuning\index{tuning!current}. The value that tchanges can be absolute
as well as relative to the current state. For an absolute change a
number or a symbolic parameter is provided, which denotes the new
value regardles of the old one. For a relative change the actual value
is used as a reference value and changed by a certain value. The
symbol \textbf{\@}\index{*A@\textat\ (at)} means semantically “\textit{the old
  value}”, which shall be referenced.

\iffalse
Eine Umstimmungsdeklaration definiert einzelne Umstimmungen und die
dazugehörenden Werte. Umstimmungsnamen dürfen nicht doppelt definiert
werden, sie dürfen jedoch gleiche Namen tragen,
wie Objekte einer anderen Art.
Eine Umstimmung enthält Regeln, nach denen die aktuelle Stimmung
\index{Stimmung!aktuelle} zu
verändern ist. Der Wert der Änderung kann sowohl absolut als auch
relativ zum alten Zustand angegeben werden. Bei einer absoluten Änderung
wird eine Zahl oder ein symbolischer Parameter angegeben, der den
neuen Wert darstellt, ohne Rücksicht auf den vorherigen Zustand.
Bei einer relativen Änderung wird der bisherige Wert als Bezugswert
genommen und um einen gewissen Betrag verändert. Semantisch bedeutet das
Symbol {\bf @}\index{at@\textat\ (at)} `{\it der alte Wert}',
auf den Bezug genommen werden soll.
\fi

If the retuning shall depend on one or more
parameters\index{parameter}, a symolic name mustbe provided for each
parameter\index{parameter!symbolic name}. This praameter name can be
used later in the retuning expression.
\iffalse
Falls die Umstimmung von einem oder mehreren Parametern\index{Parameter}
 abhängig sein soll,
so ist für jeden Parameter\index{Parameter!symbolischer Name}
 ein symbolischer Parameter-Name anzugeben.
Ein Parameter-Name kann später im Umstimmungs-Ausdruck benutzt werden.
\fi

\input{syn8.pic}

There are seven kinds of retuning expressions, which change different
properties of the actual tuning:
\iffalse
Es gibt sieben Arten von Umstimmungs-Ausdrücken, die jeweils einzelne
Merkmale der aktuellen Stimmung ver\-än\-dern:
\fi

\input{syn7.pic}

\begin{description}
\item[Retuning anchor]\index{retuning!anchor}
  corresponds to a movement of the fundamental scale. In such a tuning
  the new anchor key is defined. This new anchor key remains at its
  frequency and oll other tones are derived in such a way that the
  complete interval structure will be retained.

  In general from a change of the anchor key also a change of the
  tones results.
\iffalse
  \item[Umstimmung-Verankerung]\index{Umstimmung!Verankerung}
      entspricht einer Verschiebung
      der Fundamentaltonleiter. Dabei wird angegeben, wo sich die
      neue Verankerungs-Taste befinden soll. Diese neue Verankerungstaste
      behält ihre Frequenz bei und alle anderen Töne ergeben sich,
      indem relativ zur neuen Verankerungstaste die gesamte
      bisherige Intervallstruktur\index{Intervallstruktur}
      übernommen wird.

      Im allgemeinen folgt aus einer Veränderung der Verankerungstaste auch
      eine Veränderung der Töne.
\fi

      \input{syn9.pic}

      \input{syn26.pic}
      
    \item[Retuning width]\index{retuning!width}
      corresponds to a change in the width of the fundamental
      scale. The first tone of the fundamental scale remaines at its
      current value, and all tones right of it remain also at their
      current state. Then they are counted, how many of them will be
      needed, to reach the new width of the fundamental scale. These
      form the new fundamental scale. The interval from the anchor key
      to the first key after the fundamental scale is treated as the
      new period interval.
\iffalse
  \item[Umstimmung-Breite]\index{Umstimmung!Breite}
      entspricht einer Veränderung der Breite
      der Fundamentaltonleiter.\index{Fundamentaltonleiter!Breite der}
      Der erste Ton der Fundamentaltonleiter bleibt erhalten und alle
      Töne rechts davon werden im aktuellen Zustand festgehalten.
      Dann wird abgezählt, wieviele der festgehaltenen Töne benötigt
      werden, um die neue Breite der Fundamentaltonleiter zu erhalten.
      Diese Töne bilden dann die neue Fundamentaltonleiter.
      Das Intervall von der Verankerungstaste zur ersten Taste nach der
      Fundamentaltonleiter ergibt das neue Periodenintervall.
\fi

      In general, a change of the width leads also to a change of the
      period interval. A change of the period interval will be
      ignored, if it leeds to a value smaller than 1. A shortening of
      the width will be ignered too, if it leads to a width smaller
      than 1 or to a width greater than 60.
\iffalse
      Im allgemeinen folgt aus der Veränderung der Breite auch eine Veränderung
      des Periodenintervalls. Eine Verkürzung der Breite, die zu einer
      Breite kleiner 1 führt, wird ignoriert. Eine Verbreiterung, die
      zu einer Breite von mehr als 60 Tasten führt, wird ignoriert.
\fi

      \input{syn10.pic}

      
    \item[Retuning tones]\index{retuning!tones} corresponds to a
      change of individual tones in the fundamental scale. For each
      tone a calculation expression is provided, which denotes how the
      tone changes. These expressions are devided by commas and
      correspond to the tones in the same way, as they are denoted by
      tone systems. In case of a constant tone the symbol
      \keyword{\@}\index{*A@\textat\ (at)} must be used, sine \emph{nothing}
      means that the tone will be muted. If the number of expressions
      is smaller than the width of the fundamental scale the remaining
      tones are not changed. If the width of the fundamental scale is
      smaller than the number of expressions, the remaining
      expressions have no effect.
\iffalse
  \item[Umstimmung-Töne]\index{Umstimmung!Töne}
      entspricht einer Änderung einzelner Töne
      innerhalb der Fundamentaltonleiter.
      Hier wird für jeden Ton der Fundamentaltonleiter ein Rechenausdruck
      angegeben, um den sich der Ton zu verändern hat. Diese Rechenausdrücke
      sind durch Kommata getrennt und beziehen sich in ihrer Reihenfolge
      auf die entsprechenden Töne, wie sie bei einem Tonsystem
      angegeben werden.
      Soll ein Ton unverändert
      erhalten bleiben, so ist dafür das Symbol \keyword{\@}\index{{\@ (at)}}
      zu schreiben, weil
      `{\it nichts}' bedeutet, daß der Ton stumm geschaltet wird.
      Falls die Anzahl der Rechenausdrücke kleiner ist, als die
      Breite der Fundamentaltonleiter, so bleiben die überzähligen Töne
      unverändert. Falls die Breite der Fundamentaltonleiter kleiner ist,
      als die Anzahl der Rechenausdrücke, so bleiben die
      überzähligen Rechenausdrücke ohne Effekt.
\fi

      \input{syn11.pic}

      \input{syn12.pic}
    \item[Retuning period]\index{retuning!period} 
      corresponds to a change of the period interval\index{period
        interval}. Here, the value of the period interval is changed
      such that the tones of the fundamental scale remain constant,
      but all other tones are recalculated, as they arise from the
      fundamental scale and the period interval.
\iffalse
  \item[Umstimmung-Periode]\index{Umstimmung!Periode}
      entspricht einer Änderung des
      Periodenintervalls\index{Periodenintervall}.
      Hier wird der Wert des
      Periodenintervalls verändert, so daß die Töne der Fundamentaltonleiter
      erhalten bleiben, aber alle anderen Töne neu berechnet werden,
      da sie sich aus der Fundamentaltonleiter und der Periodenverschiebung
      ergeben.
\fi

      \input{syn13.pic}


    \item[Retuning bundle]\index{retuning!bundle}
      A retuning bundle contains a sequence of actions.\index{action}
      The different actions can call other retunings, tone systems or
      logics, or they can send MIDI messages. Also here, no circular
      dependencies are allowed. The individual actions will be
      executed in the given order. The parameters\index{parameter} of
      a retuning bundle can be passed to the individal calls, as long
      the action is a retuning an it accepts sufficiently many
      parameters. The given parameters will be assigned in the same
      order to the parameters of the called retuning as they are
      provided.
\iffalse
  \item[Umstimmungs-Bund]\index{Umstimmung!Bund}
      Ein Umstimmungsbund umfasst eine Folge von
      Aktionen.\index{Aktionen} Die einzelnen
      Aktionen können andere Umstimmungen,
      Tonsysteme oder Logiken aufrufen, oder auch MIDI-Nachrichten
      senden. Dabei dürfen keine gegenseitigen
      Abhängigkeiten entstehen. Die einzelnen Aktionen werden in der
      aufgeführten Reihenfolge ausgeführt.
      Die Parameter\index{Parameter} eines
      Umstimmungsbundes können an die einzelnen Aufrufe weitergegeben
      werden, sofern der aufgerufene Name eine Umstimmung ist und
      diese Umstimmung auch entsprechend viele Parameter akzeptiert.
      Die mitgegebenen Parameter werden in der gleichen Reihenfolge
      den Parameter-Namen der Umstimmung zugeordnet.
\fi


      \input{syn14.pic}

      \input{syn28.pic}

      \input{syn23.pic}

      \input{syn17.pic}

    \item[Retuning alternative]\index{retuning!alternative} A retuning
      alternative allows the selection of one alternative from a set
      of choices in dependency of a parameter\index{parameter} of the
      retuning (the selector\index{selector}). Each alternative consists
      of a constant, which determines the case, and a sequence of
      action, which will be executed if the choice selects this
      alternative. The individual actions of an alternative are
      delimited by commas (\keyword{,}), while complete alternatives
      are not seperated by any special delimiter. The constants of the
      alternatives must be unique integers. At the end of an
      alternative a special constant \keyword{else}\index{else} can be
      used. If the selector coinsides with a constant the
      corresponding alternative is executed. If it is not equals to
      any constant and the constant \keyword{else} is given the
      alternative of the \keyword{else} branch is used. If the selector
      is different from any constant and the special constant \keyword{else} is
      not given, no alternative will be executed. The call of the
      retuning has no effect in this case.
\iffalse
    \item[Umstimmungs-Alternative]\index{Umstimmung!Alternative} Eine
      Umstimmungs-Alternative ermöglicht die Auswahl einer von
      mehreren Alternativen in Abhängigkeit eines
      Parameters\index{Parameter} der Umstimmung (der
      Selektor\index{Selektor}).  Die Alternativen bestehen jeweils
      aus der Konstanten, die einen der möglichen Fälle bestimmt, und
      einer Folge von Aktionen, welche durchgeführt werden, falls die
      Auswahl für diese Alternative zutrifft. Die einzelnen Aktionen
      einer Alternative sind mit Komma (\keyword{,}) getrennt, während
      komplette Alternativen nicht durch ein besonderes Trennzeichen
      getrennt sind. Die Konstanten der einzelnen Alternativen müssen
      ganzzahlig und eindeutig sein. Am Ende der Alternativen darf
      einmalig die Spezialkonstante {\tt ansonsten}\index{Ansonsten}
      stehen. Falls der Selektor mit einer der Konstanten
      übereinstimmt, wird diese Alternative durchgeführt. Falls der
      Selektor mit keiner Konstanten übereinstimmt und die
      Spezialkonstante {\tt ansonsten} vorhanden ist, wird die
      Alternative des {\tt ansonsten}-Zweigs durchgeführt. Falls der
      Selektor mit keiner Konstanten übereinstimmt und die
      Spezialkonstante {\tt ansonsten} nicht vorhanden ist, wird keine
      der Alternativen durchgeführt, der Aufruf dieser Umstimmung
      bleibt in diesem Fall folgenlos.
\fi

      \input{syn16.pic}
    \item[Action MIDI out]\index{action!MIDI out} a MIDI output is
      started with the word \keyword{MIDIOUT}\index{MIDIOUT} and is a
      sequence of numbers which are seperated by commas and entailed
      in parentheses. For number the hexadecima writing
      (\#\emph{digits})\index{*#@\#} is allowed. The numbers bust be in
      the range from 0 to 255, as they must fit in a bye each. There
      is no control if the MIDI message is correct or meaningful.
\iffalse
      \item[Aktion-MIDI-Out]\index{Aktion!MIDI-Out}
	MIDI-Ausgaben werden mit dem Wort {\it MIDIOUT}\index{MIDIOUT}
	 eingeleitet und
sind eine in runde Klammern eingeklammerte
und durch Kommata getrennte Folge von Zahlen. Bei Zahlen ist die sedezimale
Schreibweise zulässig (\#{\it ziffern}).\index{*#@\#} Die Zahlen
müssen im Bereich von 0 bis 255 liegen, also Bytes sein. Es erfolgt keine
Kontrolle, ob es sich um eine sinnvolle MIDI-Nachricht handelt.
\fi

      \input{syn22.pic}

\end{description}

\chapter{Harmony}\label{cha:harmonie}
\index{harmony}

A harmony declaration defines individual harmonies and the
corresponding values. Harmony names must not be used twice, but they
can have the same name as objects of another kind. The value of a
harmony is a sequence of key numbers\index{key!number}, which identify
individual keys within the fundamental scale. Keys on the keyboard,
which are outside of the fundamental scale are projected into the
fundamental scale and form the projection scale\index{projection
  scale}, which has the same width as the fundamental scale, but
contains the information which (projected) keys
(chromas\index{chroma}) are currently held down. A harmony will be
recognised, if in the projection scale exactly the given keys are held
down. Hereby some keys can be ignored. The corresponding key numbers
must be preceeded by an asterisk (*)\index{#*@*
  (asterisk)}. Optionally, a reference key\index{key!reference
  key}\index{reference key}
can be used. It's value doesn't change the pattern for harmnoy
recognition, but defines a relative transposition of the reference
chroma\index{chroma!reference chroma} in the parameter
\keyword{DISTANCE}\index{DISTANCE}. If no reference key is given, its
value will be assumed as $0$, which means no transposition of the
reference chroma.

\iffalse
Eine Harmoniedeklaration definiert einzelne Harmonien und die
dazugehörenden Werte. Harmonienamen dürfen nicht doppelt definiert
werden, sie dürfen jedoch gleiche Namen tragen,
wie Objekte einer anderen Art.
Der Wert einer Harmonie ist eine Folge von Tasten-Nummern,\index{Tasten!Nummer}
welche einzelne Tasten innerhalb der Fundamentaltonleiter identifizieren.
Die Tasten der Klaviatur, welche außerhalb der Fundamentaltonleiter
stehen, werden in die Fundamentaltonleiter hineinprojiziert und
bilden die Projektionstonleiter,\index{Projektionstonleiter}
welche die gleiche Breite
hat, wie die Fundamentaltonleiter, aber stattdessen die Information
enthält, welche (projizierten) Tasten (Tonigkeiten\index{Tonigkeit})
gerade gedrückt sind.
Eine Harmonie wiederum wird erkannt, wenn in der Projektionstonleiter genau
die angegebenen Tastennummern gedrückt sind. Dabei können einzelne
Tasten unberücksichtigt bleiben. Die entsprechenden Tastennummern sind
durch einen Stern (*)\index{**@*} gekennzeichnet.
Optional kann eine Bezugstaste\index{Bezugstaste}\index{Tasten!Bezugs-}
mit angegeben werden.
Ihr Wert ändert nicht das Harmonie-Erkennungsmuster, sondern gibt
bei der Harmonieform-Analyse eine relative Verschiebung
der Bezugstonigkeit\index{Bezugstonigkeit}
 in dem Wert \keyword{ABSTAND}\index{ABSTAND} an.
Falls keine Bezugstaste angegeben ist, so wird ihr Wert als $0$ angenommen,
also ohne Verschiebung der Bezugstonigkeit.
\fi

\input{syn15.pic}



\chapter{Logic}\label{cha:logik}
\index{logic}

A logic declaration defines individual tuning logics and the
corresponding values. Logic names must not be defined twice, but can
be the same as names of objects of another kind. Logics are activatied
by a trigger\index{trigger} and consist of an initial
tuning\index{tuning!initial}\index{initial tuning} and set of
instructions\index{instruction!set of}. An initial tuning can be a
tone system\index{tone system} or a retuning\index{retuning}. It can
be omitted, in this case the prior tuning will be retained. Similar,
the set of instructions can be empty. In this case the actual tuning
will be a static tuning that doesn't change automatically. An
instruction consists of a trigger and a list of actions. An action 
can be a call to a retuning, a tone system or a logic, or it can send
a MIDI message.

\iffalse
Eine Logikdeklaration definiert einzelne Logiken und die
dazugehörenden Werte. Logiknamen dürfen nicht doppelt definiert
werden, sie dürfen jedoch gleiche Namen tragen,
wie Objekte einer anderen Art.
Logiken werden durch einen Auslöser\index{Auslöser} aktiviert und
bestehen aus einer Einstimmung\index{Einstimmung}
 und einer Menge von Anweisungen\index{Anweisung!Menge von}.
Die Einstimmung darf ein Tonsystem oder eine Umstimmung sein.
Die Einstimmung darf fehlen, in diesem Fall wird die vorherige Stimmung
beibehalten. Die Menge der Anweisungen darf ebenfalls leer sein, in diesem
Fall bleibt die Logik in der aktuellen Stimmung stehen.
Eine Anweisung wiederum besteht ebenfalls aus einem Auslöser, sowie einer
Liste von Aktionen.
Die Aktionen dürfen der Aufruf einer Umstimmung, eines Tonsystems
oder einer Logik sein, oder das Senden einer MIDI-Nachricht.
\fi

In principle, two sets of triggers exist: The triggers, which activate
one of the logics, and the triggers, which select an instruction in
the currently active logic. Ther former are called \emph{global
  triggers}\index{trigger!global} and the latter ones \emph{local
  triggers}\index{trigger!local}. When an event occurs first the set
of global triggers is checked, afterwards the set of local triggers is
checked, if the event fits to one of them. In each of these two sets
the triggers are tested in the same order as they were declared in the
tuning logic. If a global trigger is found, the corresponding logic
will be activated. If a local trigger is found, the corresponding
action will be called inside the logic. Inside the set of the global
triggers the special trigger \keyword{ELSE} is not allowed.

\iffalse
Grundsätzlich existieren zwei Mengen von Auslösern: Die Auslöser, welche
eine der Logiken aktivieren, und die Auslöser, die innerhalb der
gerade aktiven Logik die Anweisungen anwählen. Erstere nennen wir
{\it globale Auslöser}\index{Auslöser!globale}
 und letztere {\it lokale Auslöser}\index{Auslöser!lokale}. Beim Eintreffen
eines Ereignisses wird zuerst die Menge der globalen Auslöser
und dann die Menge der lokalen Auslöser überprüft, ob das Ereignis
den Auslöser auslöst. Innerhalb der globalen und lokalen Auslöser wird
in der Reihenfolge ihrer Deklaration gesucht und beim ersten zutreffenden
Auslöser die Suche beendet.
Wenn ein globaler Auslöser zutrifft, so wird in die entsprechende Logik
gewechselt. Wenn ein lokaler Auslöser zutrifft, so werden die entsprechenden
Aktionen innerhalb der aktuellen Logik aufgerufen.
Innerhalb der Menge der globalen Auslöser ist der Spezialauslöser
{\tt ansonsten}\index{ansonsten} nicht erlaubt.
\fi

\input{syn24.pic}

\input{syn27.pic}

\section{Trigger}\label{sec:ausloser}
\index{trigger}

Each of the 26 latin (ASCII)\index{ASCII} letters, a
harmony, a harmonic form, a MIDI event or the special trigger
\keyword{ELSE} can be chosen as trigger.

\input{syn18.pic}

\subsection{Keys}\index{key}\label{sec:tasten}

This trigger\index{trigger!key} consists of the word \keyword{KEY},
followed by one of the 26 latin letters. Whenever inside one of the
\mutabor{} window the
given key is pressed on the computer keyboard, this trigger is matched
as long as the window has no special meaning for it. The trigger
corresponds always to the \mutabor{} box that corresponds to the last
active window with an associated box. The first ten boxes can be 
selected using the number keys
\Ctrl+\keystroke{0} to \Ctrl+\keystroke{9}. The instruments/MIDI
channels 1–9 can be chosen by the keys \keystroke 1 to \keystroke
9. Thus, only instruments/MIDI channels 1–9 as defined below can be
controled by key triggers.
\iffalse
Dieser Auslöser\index{Auslöser!Taste}
 besteht aus dem Wort {\it Taste}\index{Tasten}, gefolgt von einem der
26 Buchstaben. Wenn innerhalb von \mutabor{} die angegebene Taste auf der
Tastatur gedrückt wird, so gilt dieser Auslöser als erfüllt.
Der Auslöser bezieht sich jeweils auf das Instrument bzw.\ MIDI-Kanal,
das vorher
mit den Zifferntasten angewählt wurde. Man kann also nur die
Instrumente/MIDI-Kanäle 1--9 mit einem Tasten-Auslöser steuern.
\fi

\input{syn19.pic}

\subsection{Harmonies}\label{sec:harmonien}
\index{Harmonies}
Harmony or pattern trigger\index{trigger!harmony}\index{trigger!pattern} can recognize either a
harmony (pattern) or a harmonic form\index{trigger!harmonic form} (shifted
pattern)\index{trigger!shifted pattern}. The harmony is called by the
name of its pattern and the contained key numbers are treated with
respect to the fundamental scale\index{fundamental scale}. All pressed
keys are projected into the fundamental scale and the resulting
key pattern is compared with the harmony. If they coicide the harmony
is treated as recognized. Optional keys must be marked by an asterisk
(*)\index{**@* (asterisk)}. They will not be conidered for comparison.

In order to further restrict the recognition of certain harmonys a
pre-key\index{pre-key} can be given. It describes which chroma the
lowest pitch must have to be recognized as the given harmony. Equally
a post-key can be given which denotes the chroma of the higest
tone. If pre-key and post-key are given, both must be matched. The
chroma corresponds to the width of the actual fundamental
scale.\footnote{This width is not fixed to 12, but can be freely
  choosen inside wide margins.} If pre-key and post-key have a chroma
that is not contained within the current fundamental scale, this
harmony cannot be played as it is contradictory. Such harmonies are
„\textit{impossible}“ trigger\index{trigger!impossible} and will issue
a warning during compilation. Practically, they have no effect, since
they cannot be true.

\iffalse
Harmonie-Auslöser\index{Auslöser!Harmonie}
 können wahlweise eine Harmonie oder eine Harmonieform
\index{Auslöser!Harmonie-Form}
erkennen. Die Harmonie wird beim Namen genannt und die enthaltenen
Tasten-Nummern beziehen sich auf die entsprechenden Ton-Nummern der
Fundamentaltonleiter\index{Fundamentaltonleiter}.
Alle gedrückten Tasten werden in die
Fundamentaltonleiter hineinprojiziert und das entstehende Tastenmuster
wird mit der Harmonie verglichen. Bei Übereinstimmung gilt die
Harmonie als erkannt. Tasten, die in der Harmonie mit einem
Stern (*)\index{**@*} gekennzeichnet sind, werden bei diesem
Vergleich nicht berücksichtigt.
Einschränkenderweise kann man mit der Vortaste\index{Vortaste} angeben,
welche Tonigkeit\index{Tonigkeit}
der tiefste Ton haben muss, damit diese Harmonie gilt. Entsprechend muss
bei Angabe der Nachtaste\index{Nachtaste} der höchste Ton
die Tonigkeit der Nachtaste
haben. Bei Angabe von Vortaste und Nachtaste müssen beide Bedingungen
erfüllt sein. Die Tonigkeit eines Tons bezieht sich hier auf die Breite
der aktuellen Fundamentaltonleiter.\footnote{Diese Breite ist nicht
auf 12 festgelegt, sondern in weiten Grenzen frei wählbar.}
Wenn Vortaste oder Nachtaste eine Tonigkeit haben, die nicht in der
Harmonie vorkommt, so kann diese Harmonie nicht gespielt werden, da sie
sich selbst widerspricht. Solche Harmonien sind '{\it unmögliche}'
Auslöser\index{Auslöser!unmögliche}
 und werden mit einer Warnung gekennzeichnet. Praktisch
bleiben sie ohne Effekt, da sie nie zutreffen können.
\fi

For a harmonic form\index{harmonic form} for the pattern will be
checked, if the harmony is true, relatively to each tone of the
fundamental scale. If such a shifted harmony is recognised, the
trigger is treated as matched and the value \keyword{DISTANCE} is set
according to the analysis of the harmony.


\iffalse
Bei einer Harmonieform\index{Harmonieform} wird überprüft,
ob die Harmonie relativ zu jedem
Ton der Fundamentaltonleiter zutrifft. Wird eine solchermaßen
verschobene Harmonie erkannt, gilt der Auslöser als erfüllt
und der Wert \keyword{ABSTAND}\index{ABSTAND} wird entsprechend der
Harmonieanalyse gesetzt.
\fi

If for the harmony a reference key\index{reference key} has been
given, then the harmony analysis will be executed relative to the
reference key.

\iffalse
Wenn bei der Harmonie eine Bezugstaste\index{Bezugstaste}
 angegeben wurde, dann wird
die Harmonie-Analyse relativ um die Bezugstaste verschoben
durchgeführt.
\fi

\input{syn20.pic}

\subsection{MIDI trigger}\index{trigger!MIDI
  event}\label{sec:midi-ereignisse}
MIDI events are started by the word \textit{MIDIIN}\index{MIDIIN} and
are sequences of numbers contained in parentheses. For the numbers the
hexadecimal writing can be used (\#\textit{hex-digits}).\index{*#@\#}
The first number must be in the range from 128 to 255, since it must
be a status byte. All following numbers must be in the range from 0 to
127, which is the range of data bytes. In the status byte the lower
four bits (channel number) must be zeros. The channel number will be
filled in according to the chosen instrument/MIDI channel such that
the MIDI event corresponds to that instrument/MIDI channel.

The status bytes\index{status byte} \textit{note on (\#90)},
\textit{note off (\#80)} and \textit{system byte (\#F0 --- \#FF)} are
not considered in the MIDI analysis.

\iffalse
MIDI-Ereignisse werden mit dem Wort {\it MIDIIN}\index{MIDIIN}
eingeleitet und
sind eine eingeklammerte Folge von Zahlen. Bei Zahlen ist die sedezimale
Schreibweise zulässig (\#{\it ziffern}).\index{*#@\#}
Die erste Zahl muss im Bereich von
128 bis 255 liegen, also ein Status-Byte sein. Alle weiteren Zahlen
müssen im Bereich von 0 bis 127 liegen, also Daten-Bytes sein.
Beim Status-Byte müssen die unteren vier Bits (Kanal-Nummer) auf Null stehen.
Die tatsächliche Kanalnummer wird dem jeweiligen
Instrument/MIDI-Kanal zugeordnet,
so daß ein MIDI-Ereignis sich jeweils auf das richtige
Instrument/MIDI-Kanal bezieht.
Die Status-Bytes\index{Status-Byte}
 {\it Note-On\index{Note-On} (\#90)}, {\it Note-Off\index{Note-Off}
  (\#80)} und
{\it System-Byte\index{System-Byte}
 (\#F0 - \#FF)} werden nicht in die MIDI-Analyse
einbezogen.
\fi

    \input{syn21.pic}

\section{Actions}\index{Actions}\label{sec:aktionen}

Actions are triggered inside a logic and can call either a
tone system or a retuning, change to another logic or send a MIDI
message. On the call of a retuning exactly the same number of
parameters\index{parameter} must be given in the same order as the
called retuning needs. The given parameters are assigned to the
parameter names in the same order as they are given in the
definition. The parameters can be numbers as well as the value
\textit{DISTANCE}\index{DISTANCE}. The value DISTANCE corresponds to
the result of the last analysis of harmonic forms, where the value of
DISTANCE will be retained until the next analysis of harmonic forms.

\iffalse
Aktionen werden innerhalb einer Logik ausgelöst und können wahlweise
ein Tonsystem aufrufen, eine Umstimmung aufrufen,
zu einer Logik wechseln oder eine MIDI-Nachricht
senden. Beim Aufruf einer Umstimmung müssen genau so viele Parameter\index{Parameter}
mitgegeben werden, wie die aufgerufene Umstimmung benötigt. Die mitgegebenen
Parameter werden in der gleichen Reihenfolge den Parameter-Namen
der Umstimmung zugeordnet. Als Parameter können Zahlen angegeben werden,
sowie der Wert {\it ABSTAND}\index{ABSTAND}.
Der Wert ABSTAND entspricht den Gegebenheiten der
zuletzt durchgeführten Harmonie-FORM-Analyse, wobei der Wert
ABSTAND bis zur nächsten Harmonie-FORM-Analyse beibehalten wird.
\fi

A logic can execute a single action or an action list, which is
denoted in braces. In the case of an action list all actions are
executed in the given order.

\iffalse
Eine Logik kann eine einzelne Aktion ausführen oder eine in geschweiften
Klammern stehende Aktions-Liste aus\-füh\-ren. Im Falle der Aktions-Liste
werden die einzelnen Aktionen der Liste in genau der angegebenen
Reihenfolge ausgeführt.
\fi

\subsection{MIDI output}\index{MIDI!output}\label{sec:midi-ausgaben}
\index{action!MIDI output}

A MIDI output is started with the word \textit{MIDIOUT}\index{MIDIOUT}
and is a sequence of numbers delimited by parentheses. For the numbers
the hexadecimal notation (\#\textit{hex digits}) can be used. The
numbers must be in the range from 0 (\#00) to 255 (\#FF) as they must
be single bytes. There is not check, whether the resulting message is
a correct MIDI message.\footnote{Currently (2011-07-03) in each message at most 4 bytes are possible.}

\iffalse
MIDI-Ausgaben werden mit dem Wort {\it MIDIOUT}\index{MIDIOUT}
 eingeleitet und
sind eine eingeklammerte Folge von Zahlen. Bei Zahlen ist die sedezimale
Schreibweise zulässig (\#{\it ziffern}). Die Zahlen
müssen im Bereich von 0 bis 255 liegen, also Bytes sein. Es erfolgt keine
Kontrolle, ob es sich um eine sinnvolle MIDI-Nachricht handelt.
\fi

\input{syn22.pic}

\chapter{MIDI channels}\label{cha:midi-kanale}
\index{MIDI!channel}
\label{MIDICHANNEL}

The midi channel declaration has been superseded by the routing system
introduced in \mutabor{} 3.0. The following descriptions is retained
for compatibility.

A MIDI channel declaration defines the correspondence, which MIDI
channel shall be recognised by \mutabor{}, and how much MIDI output
channels are assigned to the different input channels. This is
imported for the multi 16 processing\index{multi 16 processing}. The
MIDI in channels are called “\textit{instruments}”, since for each separate
MIDI in channel the corresponding logic program is used
exclusively. Up to 16 instruments can play at the same time in
different logics.\footnote{Since \mutabor{} 3.0 this limit can be
  exceeded by the usage of the routing system.} If all 16
instruments/MIDI channels are used and \mutabor{} is instructed to use
the multi 16 processing, so each instrument can play only a single
tone, since only 16 MIDI channels are available as output channels. 

\iffalse
Eine MIDI-Kanal-Deklaration definiert die Zuordnung, auf welchen
MIDI-In-Kanal \mutabor{} reagieren soll, und wieviele MIDI-Out-Kanäle
den einzelnen Eingabekanälen zugeordnet werden. Dies ist für die
Tonerzeugung nach dem Multi-16-Verfahren\index{Multi-16-Verfahren}
 nötig. Wird als
Synthesizer-Treiber das Modell FB-01\index{FB-01} eingestellt, so gilt nur
die Angabe des MIDI-In-Kanals, der Ausgabekanal wird ignoriert.
Die MIDI-In-Kanäle werden auch als {\it Instrumente} bezeichnet, da
für jeden MIDI-In-Kanal separat das gesamte Logikprogramm gilt.
Es können bis zu 16 Instrumente gleichzeitig und in
verschiedenen Logiken spielen.
Werden alle 16 Instrumente/MIDI-Kanäle
und das Multi-16-Verfahren benutzt, so kann jedes Instrument nur
noch einen einzigen
Ton gleichzeitig spielen, da nicht mehr als eben diese 16 Midikanäle
auch als Ausgabe-Kanäle verfügbar sind. Beim Modell FB-01 von Yamaha wird
eine spezielle System-exklusive Ansteuerungsmethode verwendet,
so daß hier bis zu 16 Instrumente zu je 16 gleichzeitigen Tönen
spielbar sind.
\fi

For the multi 16 processing each input channel is assigned a range of
output channels. The size of this range corresponds to the number of
tones, that can be played simultaneously using this input channel. The
channel information of the received status byte defines, for which
input channel the message is used. Each input channel can use the
complete logic program and works independently from the other input
channels. During harmonic analysis or the analysis of a MIDI input
message the channel of the message will honoured. On the screen the
user can switch between the input channels 1 to 9 by pressing the keys
\keystroke 1 to \keystroke 9. A key trigger will be considered with
respect to the currently shown input channel. If no MIDI channels have
been declared, ind if no channel assignment has been described in the
routing panel, the declaration 
\begin{lstlisting}
	MIDICHANNEL  1  ->  1 - 16
\end{lstlisting}
will be used automatically.
\iffalse
Beim Multi-16-Verfahren wird
jedem Eingabekanal ein Bereich von MIDI-Out-Kanälen zugeordnet. Die Größe
dieses Bereichs entspricht der Anzahl Töne,
die mit diesem Eingabekanal gleichzeitig gespielt werden können.
Die Kanal-Information des empfangenen Statusbytes bestimmt, für
welchen Eingabekanal die Meldung gilt.
Jeder Eingabekanal hat für sich das gesamte Logik-Programm
zur Verfügung und arbeitet unabhängig von den anderen Eingabekanälen.
Bei der Analyse einer Harmonie und bei der Analyse einer MIDI-in-Nachricht
wird berücksichtigt, auf welchen Eingabekanal es sich bezieht.
Auf dem Bildschirm kann mit den Zifferntasten 1 bis 9 zwischen den
Eingabekanälen 1 bis 9 umgeschaltet werden. Ein Tasten-Auslöser
bezieht sich immer auf den am Bildschirm angezeigten Eingabekanal.
Falls keine MIDI-Kanäle deklariert werden, und auch keine Kanalzuordnung
in der Konfigurationsdatei angegeben ist,
gilt die Deklaration
\begin{lstlisting}
	MIDIKANAL  1  ->  1 - 16
\end{lstlisting}
als automatisch gegeben.
\fi

\input{syn25.pic}

\section{Glossary}\label{sec:worterklarungen}
\begin{description}
\item[key] The piano keys are given as distances in half tones to the
  anchor key. The anchor key has number 0, the next key right of it
  number 1, the following 2 and so on.
\iffalse
\item[Taste] Die Klaviatur-Tasten werden als Abstand in
  Tastatur-Halbtönen zur Verankerungstaste angegeben. Die
  Verankerungstaste hat somit die Nummer 0, die nächste Taste weiter
  rechts die Nummer 1, die nächste die 2 usw.
\fi

\item[selector] The selector of a retuning alternative is the
  parameter, which chooses the alternative. Generally, this is a
  parameter (i.\,e. the parameter name) of the retuning and represents
  an integer.
\iffalse
\item[Selektor] Der Selektor einer Umstimmungs-Alternative ist der
  Parameter, nach dem sich die Alternativen ausrichteten. In der Regel
  ist dies ein Parameter (d.\,h. der Parametername) der Umstimmung und
  repräsentiert so eine ganze Zahl.
\fi

\item[letter] Here, each of the 26 Latin ASCII letters can be given
  (no accents or umlauts). If you press the corresponding key on the
  computer keyboard, the corresponding event will be triggered. The
  letters are treated case insensitive.
\iffalse
\item[Buchstabe] Hier können sie einen der 26 Standard-Buchstaben des
  lateinischen Alphabets angeben (also keine Umlaute). Wenn Sie dann
  auf der Computer"=Tastatur diese Taste drücken wird das zugeordnete
  Ereignis ausgelöst. Es wird dabei nicht zwischen Klein- und
  Großbuchstaben unterschieden.
\fi

\item[anchor key] The anchor key is the piano key, at which the
  fundamental scale starts and is denoted as MIDI number of the
  key. The middle c (c') has number 60, the other keys are numbered
  increasing, and decreasing, respectively, i.\,e. c\#' has number 61,
  d' number 62 and so on.
\iffalse 
\item[Verankerungs-Taste] Die Verankerungs-Taste ist die
  Klaviatur-Taste, bei der die Fundamentaltonleiter beginnt und wird
  als MIDI-Nummer der Taste angegeben (also als Zahl). Das
  eingestrichene c (c') hat die Nummer 60, die anderen Tasten sind
  aufsteigend bzw. absteigend durchnummeriert, d.\,h.  c\#' hat die
  Nummer 61, d' die 62 usw.
\fi

\item[constants] The constants are integers, which denote at which
  value of the selector the logic will switch into the following
  retuning.
\iffalse
\item[Konstanten] Die Konstanten ganze Zahlen, die festlegen, bei
  welchem Wert des Selektors in die
  darauf folgende Umstimmung verzweigt wird.
\fi

\item[names] Many calls and assignments are done in \mutabor{} using
  names. In the declaration of each object you must give it a name,
  which can be used later as reference in other declarations
\iffalse
\item[Namen] Viele Aufrufe und Zuordnungen laufen in \mutabor{}
  über die Namen ab. Beim deklarieren eines jeden Objektes müssen Sie
  diesem einen Namen geben, den Sie später als Referenz in anderen
  Deklarationen angeben können.
\fi

\item[numbers] Numbers can be denoted in \mutabor{} by integers or
  decimals with decimal point.
\iffalse
\item[Zahlen] Zahlen können in Mutabor als Ganze Zahlen oder
  Dezimalzahlen (mit Punkt als Komma) angegeben werden.
\fi


\item[MIDI values] MIDI values are integers between 0 and 2555, which
  are considered by MIDI devices as commands and data. Additionally,
  here a hexadecimal notation is allowed, which must be preceded by a
  leading hash sing (\#), e.\,g. \#9C, \#A0, \#78, \#E0, \dots 
\iffalse
\item[MIDI-Werte] MIDI-Werte sind ganze Zahlen zwischen 0 und 255, die
  von MIDI-Geräten als Befehle und Daten ausgewertet werden.
  Zusätzlich ist hier die hexadezimale Schreibweise erlaubt, der ein
  Gatterzeichen (\#) voran zu stellen ist, also z.\,B. \#9C, \#A0, \#78,
  \#E0 \dots
\fi
\end{description}

%\chapter{Konfiguration}
%\index{Konfiguration}
%
%Die Datei {\tt MUTABOR.CFG} enthält die globalen Voreinstellungen bezüglich
%der an den Instrumenten angeschlossenen Synthesizer-Treiber und
%der Voreinstellungen der Kanalzuordnung bei den MIDI-Kanälen.
%Als Treibernummern sind bisher vorgesehen:
%\begin{description}
% \item[1] System-Exclusiv, Typ Yamaha FB01
% \item[2] Standard Midi nach Multi-16-Methode
%\end{description}
%Falls hier MIDI-Kanäle deklariert sind, so gilt deren Kanal-Zuordnung,
%es sei denn, das Logikprogramm gibt eine eigene Kanal-Zuordnung vor.
%Falls keinerlei Kanalzuordnung getroffen wird, so gilt die Zuordnung
%{\tt 1 -> 1 - 16} als gegeben.




\printindex
%\input{handbuch.ind}

\end{document}
